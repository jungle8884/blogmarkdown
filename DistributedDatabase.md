---
title: 分布式数据库
categories:
  - 计算机技术
tags:
  - 分布式数据库
date: 2019-09-07 18:25:19
author: Jungle
---
### 什么是透明？解释分布式透明:
	- 透明: [客观存在但是根本感觉不到的特性]
		- 计算机术语“透明”可能指客观存在并且运行着但是我们看不到的特性。
		- 即它客观存在，但对于大多数、特定类别的开发人员而言是不需要了解的东西，这就是计算机学中所指的透明。
		- 换种说法，透明就是一个黑盒，你只需要应用它给出的接口，而不需要了解其内在机理。
	- 分布式透明:
		- 分布透明性: 用户看到的是全局数据模型的描述, 使用时不需要考虑数据的储存和执行的场地. [对不是本地的数据库的操作就像是操作本地数据库一样]
		- 分片透明性: 用户在使用时不用考虑数据分片的细节, 数据分片的细节有系统自动完成.
		- 复制透明性: 数据可以重复存储在不同的场地上, 由系统完成对荣誉数据的控制, 提高系统的可用性和可靠性.
		- 场地自治性: 局部场地独立的自主运行能力.
			- 包括如下:	
				- 设计自治性: 独立决定本地数据库系统的设计
				- 通信自治性: 独立决定如何与其他场地通信
				- 执行自治性: 自主决定怎么局部操作
### 举例分布式库系统案例，针对案例阐述作用及特点 [[参考链接](https://github.com/alibaba/oceanbase/tree/master/oceanbase_0.4 "github地址")]
	- 案例: 
		- OceanBase[淘宝研发的千亿级海量数据库]
	- 作用:
		- 实现了数千亿条记录、数百ＴＢ数据上的跨行跨表事务
	- 特点:
		- 支持跨行跨表事务的特点，应用程序将因此而简单
		- 数据分布式存储的特点，解决了容量问题，避免了分库分表策略给业务应用带来的复杂影响，解决了系统横向性能扩容问题
		- 系统的自动容错处理，简化了系统的管理，提高了系统的可用性

### 阐述分布式数据库系统的关键技术
	- 分布式数据库设计
		- 如何恰当地对数据进行分片设计, 以及如何合理分布数据于各个场地上
		- 如何设定复制型和非复制型数据, 以及如何有效地评价其效益和代价
		- 如何实现元数据管理
	- 查询处理
		- 对于分布在不同场地上的数据, 如何解决事务到数据操作命令的转换问题
		- 如何有效利用各场地的处理能力, 同时减少各场地间的数据通信代价
		- 如何选择副本和执行场地, 以最小访问时间执行查询策略的优化问题
	- 并发控制
		- 对多个用户并发访问的同步问题, 并保证数据的完整性和一致性
		- 保证事务的一致性和隔离性问题
		- 解决和预防死锁问题
	- 可靠性
		- 系统故障恢复问题
		- 事务的原子性和耐久性实现问题
	- 安全性
		- 用户授权和认证问题
		- 访问权限控制问题
		- 数据的加密与解密

### 课本概念
- 外模式: 数据库用户的数据视图 [view], 可以看见和使用的局部数据的逻辑结构和特征的描述.
- 模式:	 关于数据库中全体数据的逻辑结构和特征的描述, 是所有用户的公共数据试图. [一张表的定义]
- 内模式: 关于数据物理结构和存储方式的描述, 数据在数据库内部的表示方式.
- 分布式数据库分为四层: 全局外层[用户层], 全局概念层, 局部概念层, 局部内层.

----------

### 第二章, 第三章

#### 课堂作业
1. 系统结构: 包括组成系统的组件, 定义各组件的功能及组件之间的内部联系 和 彼此间的作用.
	- 可以从不同的角度来描述一个系统的体系结构
	- 基于层次结构: 依据系统不同层次的功能描述系统的构成.
	- 基于组件结构: 定义系统的构成组件及组件间的关系.
	- 基于数据模式结构: 定义不同的数据类别结构及其相互关系, 定义不同的视图提供给相应的组件应用.
2. 详细解释 图2-3 [page15] C/S结构, 客户端与用户打交道, 服务端完成数据的管理.
3. 事务管理的四个特性: 
	- 事务: 应用程序中一系列逻辑相关的操作，所有操作必须成功完成，否则在每个操作中所作的所有更改都会被撤消。
	- 原子性: 事务是数据库的逻辑工作单位，不可分割，事务中包含的各操作要么都做，要么都不做
	- 一致性: 事务执行的结果必须是使数据库从一个一致性状态变到另一个一致性状态
		- 当数据库只包含成功事务提交的结果时，就说数据库处于一致性状态
		- 如果数据库系统运行中发生故障，有些事务尚未完成就被迫中断，这些未完成事务对数据库所做的修改有一部分已写入物理数据库，这时数据库就处于一种不正确的状态，或者说是 不一致的状态
	- 隔离性: 一个事务的执行不能其它事务干扰 
	- 持续性: 也称永久性，指一个事务一旦提交，它对数据库中的数据的改变就应该是永久性的，不能回滚
4. 同构和异构代表什么?
	- 同构: 指的是一个保持结构的双射. [个人理解: 相同的结构]
		- 数学中，一个由集合X映射至集合Y的函数，若对每一在Y内的y，存在唯一一个在X内的x与其对应，则此函数为双射函数。换句话说，f是双射的，如果其为两集合间的一一对应。即，同时为单射和满射。
		- 同构是在数学对象之间定义的一类映射，它能揭示出在这些对象的属性或者操作之间存在的关系。若两个数学结构之间存在同构映射，那么这两个结构叫做是同构的。
	- 异构: 不同的结构.
5. 分布式数据库的三个特性:  
	- 分布性: 各组成单元是否位于同一场地上.
	- 异构性: 系统的各组成单元是否相同. [相同为同构, 不同为异构.]
		- 数据异构性: 数据在格式, 语法和语义上存在不同.
		- 数据库系统异构性: 各场地上的局部数据库系统是否相同.
		- 平台异构性: 计算机系统是否相同.
	- 自治性: 每个场地的独立自主能力.
6. 分布式数据库怎么设计?
	- 存在两种设计策略
	- 自上而下 [Top-Down]: 适用于新设计一个数据库系统, 从无到有的设计与实现过程.
		- 需求分析
		- 概念设计
		- 分布设计
		- 分片设计
		- 分配设计
		- 物理设计
		- 系统调优
	- 自下而上 [Bottom-Up]: 适用于已存在多个数据库系统, 并需要将它们集成为一个数据库的设计过程.
		- GAV [Global As View]
		- LAV [Local As View]
7. 什么是分片, 分片的作用是什么? 如何分片?
	- 分片: 对全局数据的划分.
		- 片段: 分布式数据库中数据的存储单位, 分片的结果即片段.
		- 分配: 对片段的存储场地的指定.
	- 分片的作用: 
		- 减少网络传输量. [允许复制存储]
		- 增大事务处理的局部性. [减少数据访问的时间]
		- 提高数据的可用性和查询效率. 
		- 均衡负载. [就近访问]
	- 如何分片: 
		- 遵循分片原则: 
			- 完备性: 所有全局数据必须映射到某个片段上.
			- 可重构性: 所有片段必须可以重新构成全局数据.
			- 不相交性: 划分的各片段所包含的数据的交集为空.
		- 方法:
			- 水平分片: 按行进行划分.
			- 垂直分片: 按列进行划分.
			- 混合分片: 既包括水平分片, 也包括垂直分片.
8. 分片的表示方法是什么?
		- 图像表示法
			- 全局关系: 整体矩形
			- 片段关系: 矩形的一部分
			- 水平分段: 水平划分的部分
			- 垂直分段: 垂直划分的部分
			- 混合分段: 既有水平分段, 又有垂直分段.
		- 分片树表示法
			- 全局关系: 根节点
			- 片段关系: 叶子节点
			- 分片操作: 边
9. 分完片以后, 如何进行分配?  
		- 分为三种:
			- 分割式分配: 每个片段只存储在一个场地上
			- 全复制分配: 每个片段在每个场地上都有副本
			- 部分复制分配: 每个片段只有在部分场地上有副本

#### 课本概念
- AP: 应用处理器, 用于完成客户端的用户查询处理和分布式数据处理的软件模块.
	- 用户接口: 检测用户身份, 接受用户命令.
	- 语义数据控制器: 视图管理, 安全控制, 语义完整性控制等.
	- 分布式查询处理器: 将用户命令翻译成数据库命令.
	- 分布式事务管理器
	- 全局字典
- DP: 数据处理器, 负责进行数据管理的软件模块.
	- 局部查询处理器: 分布式查询命令到局部命令的转换.
	- 局部事务管理器
	- 局部调度管理器
	- 局部恢复管理器
	- 存储管理器: 按调度命令访问数据库.
	- 局部字典
- CM: 通信处理器, 负责为AP和DP在多个场地之间传送命令和数据.
- GES: 全局外模式: 全局用户视图. [具有分布透明性]
- GCS: 全局概念模式: 分布式数据库的整体抽象, 包含了全部数据特性和逻辑结构.
	- 经过分片模式和分配模式映射到局部模式.
	- 分片模式: 描述全局数据的逻辑划分视图, 即根据某种条件将全局数据逻辑结构划分为局部数据逻辑结构. [分片透明性]
	- 分配模式: 描述局部数据逻辑的局部物理结构, 即划分后的片段的物理分配视图. [复制透明性]
- GFS: 全局片段模式
- GAS: 全局分配模式
- LCS: 局部概念模式: 局部概念视图, 描述局部场地上的局部数据逻辑结构.
- LIS: 局部内模式: 局部物理视图, 对物理数据库的描述.
- P2PDBS: 对等数据库系统
- 非集中的多数据库系统(DDBS和MDBS)分为四层模式结构:
	- 局部模式 [Local schema]: 本地数据库的模式
	- 成员模式 [Member schema]: 本地数据库模式转换后的规范模式 [canonical model]
	- 输出模式 [export schema]: 本地模式允许被共享的数据模式
	- 联邦模式 [federated schema]: 描述内部输出模式的分布和分配特性
- 元数据: 描述基本数据的数据
- 数据字典: 存放与系统有关的元数据和各种控制信息的数据库


----------

### 第四章

#### 课堂作业
1. 查询优化为什么要优化？
	- 使局部处理代价和通信代价最小化，快速并且高效地得到查询结果。
2. 优化的内容是什么，请举例说明。
	- 内容: 
		- 执行运算的次序
		- 执行每种运算的方法
		- 所访问的副本场地
		- 执行运算的场地的选择
	- 举例: 设有两张表SUPPLIER(S)和SUPPLY(SP)是分布式存储的, S和SP各分为两个场地, 即场地1~4; 现有查询场地5, 从它开始发出查询.
		- 执行计划1: 所有场地的数据分片传到查询场地5并执行选择, 连接, 投影等运算.
		- 执行计划2: 首先在场地1、 场地2局部场地执行选择运算, 然后将选择运算的结果传输到场地3、 场地4, 对应地执行连接运算, 最后将场地3和场地4的连接结果传输到查询场地5.
		- 显然, 执行计划2所消耗的代价远远小于执行计划1.	
3. 如何把分片树转换成查询树。
	- 将分片树的水平节点转换为查询树的并集节点
	- 将分片树的垂直节点转换为查询树的连接节点
	- 用替换后的分片树代替分布式查询树中的全局关系, 得到查询树.
4. 写出下题中的查询语句，关系代数表示和全局查询树。
	- 设有一供应关系数据库, 有供应者和供应关系, 具体如下:
		- 供应者关系: SUPPLIER(SNO, SNAME, AREA)		SNO供应者编号, SNAME供应者姓名, AREA供应者所属地域
		- 供应关系: SUPPLY(SNO, PNO, QTY)			QTY数量
		- 零件关系: PART(PNO, PNAME)					PNO零件号, PNAME零件名称
	- 查询要求: 找出供应100号零件的供应者的姓名.
		- SQL: Select SNAME from SUPPLIER S, SUPPLY SP Where S.SNO = SP.SNO and SP.PNO = 100;
		- 关系代数: 见附件
		- 全局查询树: 见附件


----------

### 第五章

#### 课堂作业
1. 什么是半连接? [semi-join]
	- 在两个关系的连接操作结果上执行在其中一个关系属性上的投影.
	- 是在连接和投影操作基础上定义的一种导出关系代数操作, 是对全连接操作的一种缩减.
2. 半连接的作用.
	- 能够减少其左变元关系的基数的关系操作, 在以减少通信代价为优化目标的分布式查询中具有重要意义.
3. SDD-1优化技术.
	- 目标: 最小化场地之间的数据传输量, 从而得到最小的总体时间代价.
	- SDD算法由两部分组成: 
		- 基本算法: 
			- 对查询进行初始化
			- 选择收益最大的半连接策略
			- 选择连接执行场地
		- 后优化处理:
			- 将基本算法得到的执行策略进行修正, 以得到更合理的执行策略.